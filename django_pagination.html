<!DOCTYPE html>
<html>
<head>
	<title>
		Yet another one IT blog.
	</title>
</head>
<body>
	<h1>Пагинация в Django - простой и удобной способ дозирования информации.</h1>
	<p>Зачастую в базе данных может накопиться огромное количество информации, и выдавать браузеру 200 статей блога или 2000 единиц товара - верный способ потерять посетителя ресурса. Для регулировки объёма поступаемых данных придумали пагинацию (от английского "page" - страница), способ выдавать данные постранично.</p>
	
	<p>В Django на уровне ядра есть модуль, в котором есть всё необходимое, импортируется в одну строку:<br />
<code style="white-space: pre;">
from django.core.paginator import Paginator, PageNotAnInteger, EmptyPage
</code></p>

	<p>Из учебного проекта по созданию магазина (часть функции поиска товара по запросу): <br />
<code style="white-space: pre;">
products = Product.objects.filter(
	Q(title__icontains=query) |
	Q(country__icontains=query) |
	Q(description__icontains=query)
	)
page = request.GET.get('page', 1)
paginator = Paginator(products, 4)
try:
	products = paginator.page(page)
except PageNotAnInteger:
	products.paginator.page(1)
except EmptyPage:
	products.paginator.page(paginator.num_pages)
products = paginator.page(page)
</code>

<p>Интересно то, что Paginator'у всё равно, куда пойдут эти данные - шаблону для отрисовки веб-страницы или jsonify для отправки приложению через API, он делает ровно одну функцию - выделение необходимого куска данных для передачи.</p>

<p>В моём коде сначала находятся все товары, в ключевых полях которых встречается слово, переданное в запросе. Потом из запроса берётся номер страницы. Дальше дело за малым:</p>
<ul>
<li>Создаётся объект Paginator, которому передаётся пакет полученных объектов и целое число - количество объектов на одной странице.</li>
<li>У Paginator'а запрашивается конкретная страница из пакета с объектами. Всё. Надо обработать нештатные ситуации.</li>
<li>Если всё-таки передали не число, то я предпочитаю возвращать первую страницу, как будто ничего не произошло.</li>
<li>Если передали запредельно большое число, то Paginator сгенерирует страницу без объектов. Очевидно, что это не то, чего я от него жду, поэтому я передаю содержимое последней страницы.</li>
</ul>
<p>Всё, технология простая и очень удобная. Благодаря ей не ломается дизайн и не нагружается сеть, что в эпоху мобильных приложений снова стало важным.</p>